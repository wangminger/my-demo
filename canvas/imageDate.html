<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>imageData</title>
</head>
<body>
	<canvas id="drawing" width="1920" height="1080" style="border: 1px solid"></canvas>
	<img src=" summer.jpg" id="img" width="1920" height="1080" />
	<script type="text/javascript">
		window.onload = function() {
		var drawing = document.getElementById("drawing");
		if (drawing.getContext) {
			var context = drawing.getContext("2d"),
				image = document.images[0],
				imageData, data,
				i, len, average,
				red, green, blue, alpha;
			//绘制原始图像
			context.drawImage(image,0,0);
			//取得图像数据
			imageData = context.getImageData(0,0,image.width,image.height);
			data = imageData.data;

			for (var i = 0; i < data.length; i+=4) {
				red = data[i];
				green = data[i+1];
				blue = data[i+2];
				alpha = data[i+3];
				//求平均值
				average = Math.floor((red + green + blue)/3);

				//设置颜色值，透明度不变
				data[i] = average;
				data[i+1] = average;
				data[i+2] = average;
			}
			//回写数据，并显示结果
			imageData.data = data;
			context.putImageData(imageData, 0, 0);
		}
	}
	</script>
</body>
</html>